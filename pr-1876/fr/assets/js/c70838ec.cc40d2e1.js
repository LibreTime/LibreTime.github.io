"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[5962],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return m}});var r=n(67294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n,r,s={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var u=r.createContext({}),l=function(e){var t=r.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=l(e.components);return r.createElement(u.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},c=r.forwardRef((function(e,t){var n=e.components,s=e.mdxType,a=e.originalType,u=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),c=l(n),m=s,f=c["".concat(u,".").concat(m)]||c[m]||d[m]||a;return n?r.createElement(f,i(i({ref:t},p),{},{components:n})):r.createElement(f,i({ref:t},p))}));function m(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var a=n.length,i=new Array(a);i[0]=c;var o={};for(var u in t)hasOwnProperty.call(t,u)&&(o[u]=t[u]);o.originalType=e,o.mdxType="string"==typeof e?e:s,i[1]=o;for(var l=2;l<a;l++)i[l]=n[l];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}c.displayName="MDXCreateElement"},74163:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return u},default:function(){return m},frontMatter:function(){return o},metadata:function(){return l},toc:function(){return d}});var r=n(83117),s=n(80102),a=(n(67294),n(3905)),i=["components"],o={title:"Historique de diffusion"},u=void 0,l={unversionedId:"user-manual/playout-history",id:"user-manual/playout-history",title:"Historique de diffusion",description:"Dans la page Statistiques, le menu Historique de diffusion vous permet d'afficher une liste des fichiers lus dans une plage de dates et d'heures sp\xe9cifique. Cette page est con\xe7ue pour aider votre station \xe0 pr\xe9parer les rapports destin\xe9s aux soci\xe9t\xe9s de perception des droits musicaux et aux organismes de r\xe9glementation.",source:"@site/i18n/fr/docusaurus-plugin-content-docs/current/user-manual/playout-history.md",sourceDirName:"user-manual",slug:"/user-manual/playout-history",permalink:"/pr-1876/fr/docs/next/user-manual/playout-history",draft:!1,editUrl:"https://github.com/libretime/libretime/blob/main/docs/../docs/user-manual/playout-history.md",tags:[],version:"current",frontMatter:{title:"Historique de diffusion"},sidebar:"tutorialSidebar",previous:{title:"Listes de lecture et blocs intelligents",permalink:"/pr-1876/fr/docs/next/user-manual/playlists"},next:{title:"Podcasts",permalink:"/pr-1876/fr/docs/next/user-manual/podcasts"}},p={},d=[{value:"Enregistrement manuel",id:"enregistrement-manuel",level:3},{value:"Mod\xe8le d&#39;historique",id:"mod\xe8le-dhistorique",level:2},{value:"Exportation de la programmation #exporting}",id:"exportation-de-la-programmation-exporting",level:2},{value:"Mise en cache des informations sur les horaires",id:"mise-en-cache-des-informations-sur-les-horaires",level:3},{value:"Pousser les informations de programmation via FTP ou SSH",id:"pousser-les-informations-de-programmation-via-ftp-ou-ssh",level:3}],c={toc:d};function m(e){var t=e.components,o=(0,s.Z)(e,i);return(0,a.kt)("wrapper",(0,r.Z)({},c,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Dans la page ",(0,a.kt)("strong",{parentName:"p"},"Statistiques"),", le menu ",(0,a.kt)("strong",{parentName:"p"},"Historique de diffusion")," vous permet d'afficher une liste des fichiers lus dans une plage de dates et d'heures sp\xe9cifique. Cette page est con\xe7ue pour aider votre station \xe0 pr\xe9parer les rapports destin\xe9s aux soci\xe9t\xe9s de perception des droits musicaux et aux organismes de r\xe9glementation."),(0,a.kt)("p",null,"Les r\xe9sultats de la recherche peuvent \xeatre copi\xe9s dans le presse-papiers \xe0 l'aide du bouton ",(0,a.kt)("strong",{parentName:"p"},"Copier"),", export\xe9s sous forme de donn\xe9es au format ",(0,a.kt)("strong",{parentName:"p"},"CSV")," (comma separated values), export\xe9s sous forme de document au format ",(0,a.kt)("strong",{parentName:"p"},"PDF")," ou affich\xe9s dans un format imprimable \xe0 l'aide du bouton ",(0,a.kt)("strong",{parentName:"p"},"Imprimer"),". (Votre navigateur web doit avoir un plugin Adobe Flash install\xe9 pour que ces boutons apparaissent). Une fois l'impression termin\xe9e, appuyez sur la touche ","*","*","Esc\xf9\xf9 pour revenir \xe0 l'interface LibreTime."),(0,a.kt)("p",null,"Cette page comporte trois onglets : ",(0,a.kt)("strong",{parentName:"p"},"log sheet"),", ",(0,a.kt)("strong",{parentName:"p"},"file summary")," ,",(0,a.kt)("strong",{parentName:"p"},"show summary"),". Sur chacun de ces onglets, vous pouvez s\xe9lectionner une plage de dates et d'heures en cliquant sur les ic\xf4nes de calendrier et d'horloge dans le coin sup\xe9rieur gauche de la page. Cliquez ensuite sur le bouton de recherche, qui comporte une ic\xf4ne en forme de loupe, \xe0 droite. Une liste des fichiers lus pendant cette p\xe9riode appara\xeetra plus bas sur la page."),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(21609).Z,width:"1117",height:"576"})),(0,a.kt)("p",null,"Dans l'onglet ",(0,a.kt)("strong",{parentName:"p"},"Log Sheet"),", l'historique de la lecture est tri\xe9 par d\xe9faut par ",(0,a.kt)("strong",{parentName:"p"},"Heure de d\xe9but")," et ",(0,a.kt)("strong",{parentName:"p"},"Heure de fin"),"."),(0,a.kt)("p",null,"Le nombre de fois que chaque fichier a \xe9t\xe9 lu et la longueur des fichiers sont indiqu\xe9s dans l'onglet ",(0,a.kt)("strong",{parentName:"p"},"file summary"),". Pour une utilisation optimale de cette fonctionnalit\xe9 \xe0 des fins de d\xe9claration de redevances, les fichiers musicaux doivent \xeatre \xe9tiquet\xe9s avec les m\xe9tadonn\xe9es ",(0,a.kt)("strong",{parentName:"p"},"Composer")," et ",(0,a.kt)("strong",{parentName:"p"},"Copyright"),". L'artiste qui interpr\xe8te un morceau de musique peut ne pas \xeatre le compositeur original de l'\u0153uvre, ni le d\xe9tenteur des droits d'auteur de l'enregistrement sonore."),(0,a.kt)("p",null,"Dans l'onglet ",(0,a.kt)("strong",{parentName:"p"},"show summary"),", cliquez sur le nom d'un spectacle dans la plage de recherche pour d\xe9velopper sa ligne et voir les d\xe9tails de sa diffusion."),(0,a.kt)("h3",{id:"enregistrement-manuel"},"Enregistrement manuel"),(0,a.kt)("p",null,"Si votre station dispose d'une diffusion \xe0 partir de sources analogiques telles que des platines ou des microphones, LibreTime ne collecte pas automatiquement les m\xe9tadonn\xe9es de ces entr\xe9es. Pour vous assurer que l'historique des diffusions est complet, vous pouvez ajouter des entr\xe9es manuellement en cliquant sur le bouton ",(0,a.kt)("strong",{parentName:"p"},"+ Cr\xe9er une nouvelle entr\xe9e de log"),". Cette action ouvre une fen\xeatre pop-up avec des champs par d\xe9faut de Start Time, End Time, Title et Creator. Cliquez sur le bouton ",(0,a.kt)("strong",{parentName:"p"},"Find")," pour remplir automatiquement le menu ",(0,a.kt)("strong",{parentName:"p"},"Choose Show Instance")," avec les noms des \xe9missions qui ont eu lieu dans la plage de temps sp\xe9cifi\xe9e. Cliquez ensuite sur le bouton ",(0,a.kt)("strong",{parentName:"p"},"Enregistrer")," pour entrer le nouvel \xe9l\xe9ment dans l'historique de diffusion."),(0,a.kt)("p",null,"Les entr\xe9es du journal peuvent \xe9galement \xeatre supprim\xe9es manuellement, en utilisant le bouton avec l'ic\xf4ne de la corbeille, \xe0 droite du bouton ",(0,a.kt)("strong",{parentName:"p"},"+ Cr\xe9er une entr\xe9e"),". Les pages des entr\xe9es peuvent \xeatre s\xe9lectionn\xe9es pour \xeatre supprim\xe9es \xe0 l'aide du menu d\xe9roulant ",(0,a.kt)("strong",{parentName:"p"},"S\xe9lectionner"),"."),(0,a.kt)("h2",{id:"mod\xe8le-dhistorique"},"Mod\xe8le d'historique"),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(92841).Z,width:"411",height:"403"})),(0,a.kt)("p",null,"La page ",(0,a.kt)("strong",{parentName:"p"},"Mod\xe8les d'historique")," du menu ",(0,a.kt)("strong",{parentName:"p"},"Historique")," vous permet de pr\xe9parer des rapports dont le contenu exact est exig\xe9 par les organismes de r\xe9glementation des territoires sur lesquels vous diffusez. Vous pouvez commencer \xe0 cr\xe9er un mod\xe8le personnalis\xe9 en cliquant sur le bouton ",(0,a.kt)("strong",{parentName:"p"},"new log sheet template")," (Nouveau mod\xe8le de feuille de route) ou sur le bouton ",(0,a.kt)("strong",{parentName:"p"}," new file summery template")," (Nouveau mod\xe8le de r\xe9sum\xe9 de fichier)."),(0,a.kt)("p",null,(0,a.kt)("img",{src:n(82996).Z,width:"645",height:"550"})),(0,a.kt)("p",null,"L'une ou l'autre de ces actions ouvre une page dans laquelle vous pouvez nommer le nouveau mod\xe8le, et ajouter ou supprimer des \xe9l\xe9ments de la liste de gauche. Pour ajouter un nouvel \xe9l\xe9ment dans la liste de droite, cliquez sur l'ic\xf4ne plus correspondant \xe0 l'\xe9l\xe9ment souhait\xe9. Si l'\xe9l\xe9ment dont vous avez besoin ne figure pas dans la liste, vous pouvez utiliser la case ",(0,a.kt)("strong",{parentName:"p"},"Ajouter un nouveau champ")," situ\xe9e en bas de la colonne de droite. S\xe9lectionnez ",(0,a.kt)("em",{parentName:"p"},"string"),", ",(0,a.kt)("em",{parentName:"p"},"boolean"),", ",(0,a.kt)("em",{parentName:"p"},"integer"),", or ",(0,a.kt)("em",{parentName:"p"},"float"),", selon le type de donn\xe9es que vous souhaitez enregistrer, puis cliquez sur le bouton ",(0,a.kt)("strong",{parentName:"p"},"+ Ajouter"),"."),(0,a.kt)("p",null,"Lorsque le mod\xe8le a le format souhait\xe9, cliquez sur le bouton ",(0,a.kt)("strong",{parentName:"p"},"Enregistrer"),", puis sur ",(0,a.kt)("strong",{parentName:"p"},"D\xe9finir le mod\xe8le par d\xe9fau"),"t si vous le souhaitez. Le nouveau mod\xe8le sera d\xe9sormais r\xe9pertori\xe9 sur la page ",(0,a.kt)("strong",{parentName:"p"},"Mod\xe8les d'historique"),". Si vous avez d\xe9fini un nouveau mod\xe8le par d\xe9faut, les modifications seront visibles sur les onglets de la page Historique de diffusion."),(0,a.kt)("h2",{id:"exportation-de-la-programmation-exporting"},"Exportation de la programmation #exporting}"),(0,a.kt)("p",null,"LibreTime dispose d'une fonctionnalit\xe9 qui permet d'afficher les informations relatives aux \xe9missions et \xe0 la programmation de votre station sur des sites web distants. Cette fonctionnalit\xe9 est incluse dans LibreTime car vous n'invitez g\xe9n\xe9ralement pas le grand public \xe0 acc\xe9der directement \xe0 votre serveur LibreTime. Si un tr\xe8s grand nombre de personnes demandaient des donn\xe9es au serveur LibreTime en m\xeame temps, l'explosion du trafic r\xe9seau pourrait surcharger le serveur et potentiellement perturber vos \xe9missions. Si elle est malveillante, cette surcharge du r\xe9seau est connue comme une attaque par d\xe9ni de service."),(0,a.kt)("p",null,"Au lieu de cela, votre serveur web accessible au public peut r\xe9cup\xe9rer les informations relatives aux horaires \xe0 partir de l'API LibreTime. Elles peuvent \xeatre pr\xe9sent\xe9es \xe0 l'aide de widgets Javascript et stylis\xe9es avec CSS, dans le format que vous souhaitez."),(0,a.kt)("p",null,"Deux types d'informations peuvent \xeatre r\xe9cup\xe9r\xe9s \xe0 distance depuis l'API de LibreTime sans authentification : les m\xe9tadonn\xe9es de l'\xe9mission en cours et de l'\xe9mission suivante (live-info), ou la programmation de la semaine en cours et de la semaine \xe0 venir (week-info). Les m\xe9tadonn\xe9es week-info comprennent les noms des \xe9missions, les heures et les URL des \xe9missions individuelles sur votre site Web public. Ainsi, le public de votre station peut cliquer sur les informations de la grille pour en savoir plus sur une \xe9mission particuli\xe8re, ou t\xe9l\xe9charger un enregistrement d'une \xe9mission pr\xe9c\xe9dente que vous auriez pu mettre \xe0 disposition."),(0,a.kt)("p",null,"Si votre serveur LibreTime \xe9tait accessible \xe0 l'adresse ",(0,a.kt)("a",{parentName:"p",href:"https://libretime.example.com"},"https://libretime.example.com"),", les informations sur les \xe9missions en direct pourraient \xeatre r\xe9cup\xe9r\xe9es par votre serveur web en utilisant cette URL :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"https://libretime.example.com/api/live-info/?callback\n")),(0,a.kt)("p",null,"Les m\xe9tadonn\xe9es de texte s\xe9par\xe9es par des virgules renvoy\xe9es \xe0 votre serveur Web pourraient ressembler \xe0 ceci :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "env": "production",\n  "schedulerTime": "2013-07-03 14:07:31",\n\n  "previous": {\n    "name": "Earth, Wind &amp; Fire - Boogie Wonderland",\n    "starts": "2013-07-01 22:53:00",\n    "ends": "2013-07-01 22:55:00",\n    "type": "track"\n  },\n  "current": {\n    "name": "Deodato - Also Sprach Zarathustra",\n    "starts": "2013-07-03 13:07:06",\n    "ends": "2013-07-03 13:16:05",\n    "media_item_played": true,\n    "record": 0,\n    "type": "track"\n  },\n\n  "next": {\n    "id": 8,\n    "instance_id": 10,\n    "name": "Rock Show",\n    "url": "https://rock.example.com/",\n    "start_timestamp": "2013-07-03 14:00:00",\n    "end_timestamp": "2013-07-03 15:00:00",\n    "starts": "2013-07-03 14:00:00",\n    "ends": "2013-07-03 15:00:00",\n    "record": 0,\n    "type": "show"\n  },\n\n  "currentShow": [\n    {\n      "start_timestamp": "2013-07-03 14:07:00",\n      "0": "2013-07-03 13:07:00",\n      "end_timestamp": "2013-07-03 15:00:00",\n      "1": "2013-07-03 14:00:00",\n      "name": "Funk Show",\n      "2": "Funk Show",\n      "id": 7,\n      "3": 7,\n      "instance_id": 9,\n      "4": 9,\n      "record": 0,\n      "5": 0,\n      "url": "https://funk.example.com/",\n      "6": "",\n      "starts": "2013-07-03 14:07:00",\n      "7": "2013-07-03 13:07:00",\n      "ends": "2013-07-03 15:00:00",\n      "8": "2013-07-03 14:00:00"\n    }\n  ],\n\n  "nextShow": [\n    {\n      "id": 8,\n      "instance_id": 10,\n      "name": "Rock Show",\n      "url": "https://rock.example.com/",\n      "start_timestamp": "2013-07-03 15:00:00",\n      "end_timestamp": "2013-07-03 16:00:00",\n      "starts": "2013-07-03 15:00:00",\n      "ends": "2013-07-03 16:00:00",\n      "record": 0,\n      "type": "show"\n    }\n  ],\n\n  "timezone": "BST",\n  "timezoneOffset": "3600",\n  "AIRTIME_API_VERSION": "1.1"\n}\n')),(0,a.kt)("p",null,"Les informations relatives \xe0 l'horaire de la semaine en cours peuvent \xeatre r\xe9cup\xe9r\xe9es \xe0 l'aide de l'URL :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"https://libretime.example.com/api/week-info/?callback\n")),(0,a.kt)("p",null,"Dans ce cas, les m\xe9tadonn\xe9es renvoy\xe9es seraient dans un format diff\xe9rent de celui de l'exemple ci-dessus, quelque chose comme ce qui suit. Pour que l'exemple soit bref, cette exportation de programmation particuli\xe8re ne contient que quatre \xe9missions le lundi. Une exportation de programmation hebdomadaire compl\xe8te contiendrait beaucoup plus de texte."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "monday": [\n    {\n      "start_timestamp": "2013-07-01 12:05:00",\n      "end_timestamp": "2013-07-01 13:00:00",\n      "name": "Elvis Show",\n      "id": 2,\n      "instance_id": 2,\n      "record": 0,\n      "url": "https://elvis.example.com/",\n      "starts": "2013-07-01 12:05:00",\n      "ends": "2013-07-01 13:00:00"\n    },\n\n    {\n      "start_timestamp": "2013-07-01 13:00:00",\n      "end_timestamp": "2013-07-01 14:00:00",\n      "name": "News",\n      "id": 3,\n      "instance_id": 4,\n      "record": 0,\n      "url": "https://news.example.com/",\n      "starts": "2013-07-01 13:00:00",\n      "ends": "2013-07-01 14:00:00"\n    },\n\n    {\n      "start_timestamp": "2013-07-01 14:00:00",\n      "end_timestamp": "2013-07-01 15:00:00",\n      "name": "Funk Show",\n      "id": 4,\n      "instance_id": 6,\n      "record": 0,\n      "url": "https://funk.example.com/",\n      "starts": "2013-07-01 14:00:00",\n      "ends": "2013-07-01 15:00:00"\n    },\n\n    {\n      "start_timestamp": "2013-07-01 15:00:00",\n      "end_timestamp": "2013-07-01 17:30:00",\n      "name": "Rock Show",\n      "id": 5,\n      "instance_id": 7,\n      "record": 0,\n      "url": "https://rock.example.com/",\n      "starts": "2013-07-01 15:00:00",\n      "ends": "2013-07-01 17:30:00"\n    }\n  ],\n\n  "tuesday": [],\n  "wednesday": [],\n  "thursday": [],\n  "friday": [],\n  "saturday": [],\n  "sunday": [],\n  "AIRTIME_API_VERSION": "1.1"\n}\n')),(0,a.kt)("p",null,"Si vous voyez le message You are not allowed to access this resource (Vous n'\xeates pas autoris\xe9 \xe0 acc\xe9der \xe0 cette ressource) lorsque vous tentez d'afficher des informations sur les horaires dans votre navigateur Web, connectez-vous \xe0 l'interface d'administration de LibreTime, cliquez sur ",(0,a.kt)("strong",{parentName:"p"},"Syst\xe8me")," dans le menu principal, puis sur ",(0,a.kt)("strong",{parentName:"p"},"Pr\xe9f\xe9rences"),". R\xe9glez ",(0,a.kt)("strong",{parentName:"p"},'Allow Remote Websites To Access "Schedule" Info ?')," sur ",(0,a.kt)("strong",{parentName:"p"},"activ\xe9")," cliquez sur le bouton ",(0,a.kt)("strong",{parentName:"p"},"Save"),", puis rafra\xeechissez la fen\xeatre du navigateur ouverte sur l'URL d'exportation des horaires. Si vous ne souhaitez pas mettre les informations de programmation \xe0 la disposition du public, d\xe9finissez plut\xf4t cette option sur ",(0,a.kt)("strong",{parentName:"p"},"D\xe9sactiv\xe9")),(0,a.kt)("h3",{id:"mise-en-cache-des-informations-sur-les-horaires"},"Mise en cache des informations sur les horaires"),(0,a.kt)("p",null,"Si le serveur LibreTime est derri\xe8re un pare-feu, ou si vous voulez prot\xe9ger le serveur LibreTime d'un grand nombre de requ\xeates de programmation, vous pouvez mettre en cache les informations de programmation sur un serveur public ou interm\xe9diaire. Vous pouvez alors cr\xe9er une r\xe8gle de pare-feu qui n'autorise que le serveur de programmation \xe0 se connecter au serveur LibreTime, en plus de tous les utilisateurs distants de l'interface web de LibreTime."),(0,a.kt)("p",null,"Votre administrateur syst\xe8me peut configurer la mise en cache des horaires sur un serveur web standard Apache et PHP avec le programme curl install\xe9, en suivant les \xe9tapes suivantes :"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Cr\xe9ez un script shell sur le serveur de planification (schedule.example.com) qui interroge le serveur LibreTime distant (libretime.example.com), et \xe9crit les m\xe9tadonn\xe9es retourn\xe9es dans une paire de fichiers temporaires locaux :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"sudo nano /usr/local/bin/libretime-schedule.sh\n")),(0,a.kt)("p",null,"Le contenu de ce fichier doit ressembler au script suivant, en rempla\xe7ant libretime.example.com par le nom de votre serveur LibreTime :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},'#!/bin/sh\n\ncurl -s "https://libretime.example.com/api/live-info/?callback=***" > /tmp/live-info\n\ncurl -s "https://libretime.example.com/api/week-info/?callback=***" > /tmp/week-info\n')),(0,a.kt)("ol",{start:2},(0,a.kt)("li",{parentName:"ol"},"Rendez le script ex\xe9cutable :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"sudo chmod +x /usr/local/bin/libretime-schedule.sh\n")),(0,a.kt)("ol",{start:3},(0,a.kt)("li",{parentName:"ol"},"Cr\xe9ez une configuration VirtualHost Apache pour le serveur de planification :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"sudo nano /etc/apache2/sites-available/schedule\n")),(0,a.kt)("p",null,"contenant une d\xe9finition comme la suivante, en rempla\xe7ant schedule.example.com par le nom de votre serveur de planification :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-apacheconf"},"    <VirtualHost *:80>\n       ServerName schedule.example.com\n       DocumentRoot /var/www/schedule/\n    </VirtualHost>\n")),(0,a.kt)("ol",{start:4},(0,a.kt)("li",{parentName:"ol"},"Dans le dossier DocumentRoot du serveur de planification, cr\xe9ez les dossiers api/live-info/ et api/week-info/.")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"sudo mkdir -p /var/www/schedule/api/live-info/\nsudo mkdir -p /var/www/schedule/api/week-info/\n")),(0,a.kt)("ol",{start:5},(0,a.kt)("li",{parentName:"ol"},"Cr\xe9ez un fichier index.php dans le dossier api/live-info/ :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"sudo nano /var/www/schedule/api/live-info/index.php\n")),(0,a.kt)("p",null,"contenant le code suivant :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php"},"<?php\n$filename = '/tmp/live-info';  // define here the path and name of uploaded live-info file\n\nheader('Content-Type: text/javascript');\nheader(\"Expires: Thu, 01 Jan 1970 00:00:00 GMT\");\nheader(\"Cache-Control: no-store, no-cache, must-revalidate\");\n\n$callback = empty($_GET['callback']) ? null : $_GET['callback'];\n$content = file_get_contents($filename);\n$content = str_replace('***', $callback, $content);\necho $content;\n?>\n")),(0,a.kt)("ol",{start:6},(0,a.kt)("li",{parentName:"ol"},"Cr\xe9ez un fichier index.php dans le dossier api/week-info/ :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"sudo nano /var/www/schedule/api/week-info/index.php\n")),(0,a.kt)("p",null,"contenant le code suivant :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-php"},"<?php\n$filename = '/tmp/week-info';  // define here the path and name of uploaded week-info file\n\nheader('Content-Type: text/javascript');\nheader(\"Expires: Thu, 01 Jan 1970 00:00:00 GMT\");\nheader(\"Cache-Control: no-store, no-cache, must-revalidate\");\n\n$callback = empty($_GET['callback']) ? null : $_GET['callback'];\n$content = file_get_contents($filename);\n$content = str_replace('***', $callback, $content);\necho $content;\n?>\n")),(0,a.kt)("ol",{start:7},(0,a.kt)("li",{parentName:"ol"},"Activez la nouvelle configuration et rechargez le serveur web Apache :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"sudo a2ensite schedule\nsudo /etc/init.d/apache2 reload\n")),(0,a.kt)("ol",{start:8},(0,a.kt)("li",{parentName:"ol"},"Cr\xe9ez une t\xe2che cron pour ex\xe9cuter le script shell chaque minute :")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"sudo nano /etc/cron.d/libretime-schedule\n")),(0,a.kt)("p",null,"contenant la ligne :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"* * * * * www-data /usr/local/bin/libretime-schedule.sh\n")),(0,a.kt)("p",null,"Le serveur de planification va maintenant servir les m\xeames informations de spectacle que le serveur LibreTime, avec une dur\xe9e de vie du cache d'une minute. Vous pouvez ajuster la dur\xe9e de vie du cache en modifiant la fr\xe9quence de la t\xe2che cron qui interroge le serveur LibreTime."),(0,a.kt)("h3",{id:"pousser-les-informations-de-programmation-via-ftp-ou-ssh"},"Pousser les informations de programmation via FTP ou SSH"),(0,a.kt)("p",null,"S'il n'y a pas d'acc\xe8s entrant au serveur LibreTime, un script FTP peut \xeatre utilis\xe9 pour pousser les donn\xe9es de programmation en cache de LibreTime vers un serveur web externe. La commande ftp standard doit \xeatre disponible sur le serveur LibreTime et le serveur web externe doit avoir un compte FTP restreint. Apr\xe8s avoir suivi les \xe9tapes 1 et 2 ci-dessus pour exporter les donn\xe9es de programmation vers une paire de fichiers temporaires sur le serveur LibreTime, cr\xe9ez un nouveau script sur le serveur LibreTime pour effectuer automatiquement le t\xe9l\xe9chargement :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre"},"sudo nano /usr/local/bin/upload-schedule-data.sh\n")),(0,a.kt)("p",null,"Remplacez les valeurs d'h\xf4te, d'utilisateur et de mot de passe par les valeurs appropri\xe9es pour votre serveur Web externe :"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"#!/bin/sh\nHOST='website.example.com'\nUSER='ftp_user'\nPASSWD='ftp_password'\n\nftp -n -v $HOST << EOT\nuser $USER $PASSWD\nascii\nprompt\nput /tmp/airtime-week-info\nput /tmp/airtime-live-info\nbye\nEOT\n")),(0,a.kt)("p",null,"Ensuite, rendez le nouveau script ex\xe9cutable et cr\xe9ez une t\xe2che cron pour le lancer toutes les minutes, comme \xe0 l'\xe9tape 8 ci-dessus. Les \xe9tapes 3 \xe0 7 ci-dessus doivent \xeatre ex\xe9cut\xe9es sur le serveur web externe afin qu'il puisse convertir les deux fichiers temporaires t\xe9l\xe9charg\xe9s par FTP en donn\xe9es publiques de planification."),(0,a.kt)("p",null,"Si vous disposez d'un acc\xe8s shell s\xe9curis\xe9 (SSH) au serveur web distant, vous pouvez \xe9crire un script pour utiliser la commande de copie s\xe9curis\xe9e (scp) au lieu de ftp."))}m.isMDXComponent=!0},92841:function(e,t,n){t.Z=n.p+"assets/images/playout-history-history-templates-91d273e01f8d5953fb784c76957aff3c.png"},21609:function(e,t,n){t.Z=n.p+"assets/images/playout-history-log-sheet-ff8a94c0e49944b88233c284201d3559.png"},82996:function(e,t,n){t.Z=n.p+"assets/images/playout-history-new-hist-temp-9b9d153feaa2faf934e5e289b5ee0110.png"}}]);